<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Simple Warrior</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <style>
        body { 
            margin: 0;
            background: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            font-family: 'Courier New', monospace;
            color: #0f0;
        }
        canvas {
            display: block;
            border: 2px solid #0f0;
        }
        #info {
            margin: 10px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="info">Loading game...</div>
    <script>
        // Get parameters from URL
        const urlParams = new URLSearchParams(window.location.search);
        const PLAYER_NAME = urlParams.get('player') || 'PLAYER';
        const DIFFICULTY = urlParams.get('diff') || 'easy';
        
        // Difficulty settings
        const speeds = {
            easy: 3,
            normal: 5,
            hard: 7
        };
        
        const coinSpeed = speeds[DIFFICULTY] || 3;
        
        // Game variables
        let player;
        let coins = [];
        let score = 0;
        let gameState = 'playing';
        
        function setup() {
            createCanvas(600, 400);
            player = {
                x: 300,
                y: 350,
                w: 30,
                h: 30,
                speed: 5
            };
            
            // Update info
            document.getElementById('info').innerHTML = 
                `Player: ${PLAYER_NAME} | Difficulty: ${DIFFICULTY} | Use Arrow Keys`;
        }
        
        function draw() {
            background(20, 20, 40);
            
            if (gameState === 'playing') {
                updateGame();
            } else {
                showGameOver();
            }
        }
        
        function updateGame() {
            // Draw player
            fill(0, 255, 255);
            rect(player.x, player.y, player.w, player.h);
            
            // Player movement
            if (keyIsDown(LEFT_ARROW)) {
                player.x -= player.speed;
            }
            if (keyIsDown(RIGHT_ARROW)) {
                player.x += player.speed;
            }
            
            // Keep player in bounds
            player.x = constrain(player.x, 0, width - player.w);
            
            // Spawn coins
            if (frameCount % 60 === 0) {
                coins.push({
                    x: random(20, width - 20),
                    y: 0,
                    w: 20,
                    h: 20,
                    collected: false
                });
            }
            
            // Update and draw coins
            for (let i = coins.length - 1; i >= 0; i--) {
                let coin = coins[i];
                
                if (!coin.collected) {
                    coin.y += coinSpeed;
                    
                    // Draw coin
                    fill(255, 215, 0);
                    circle(coin.x, coin.y, coin.w);
                    
                    // Check collision with player
                    if (coin.x > player.x && 
                        coin.x < player.x + player.w &&
                        coin.y > player.y && 
                        coin.y < player.y + player.h) {
                        coin.collected = true;
                        score += 10;
                    }
                    
                    // Remove if off screen
                    if (coin.y > height) {
                        coins.splice(i, 1);
                    }
                } else {
                    coins.splice(i, 1);
                }
            }
            
            // Draw score
            fill(255);
            textSize(20);
            textAlign(LEFT);
            text('Score: ' + score, 10, 30);
            text('Player: ' + PLAYER_NAME, 10, 55);
            
            // Simple "game over" after 30 seconds
            if (frameCount > 60 * 30) {
                gameState = 'gameover';
            }
        }
        
        function showGameOver() {
            background(0);
            fill(255);
            textSize(32);
            textAlign(CENTER, CENTER);
            text('TIME UP!', width/2, height/2 - 40);
            textSize(24);
            text('Final Score: ' + score, width/2, height/2);
            text('Player: ' + PLAYER_NAME, width/2, height/2 + 40);
            textSize(16);
            text('Press R to restart', width/2, height/2 + 80);
        }
        
        function keyPressed() {
            if (key === 'r' || key === 'R') {
                score = 0;
                coins = [];
                gameState = 'playing';
                frameCount = 0;
            }
        }
    </script>
</body>
</html>
